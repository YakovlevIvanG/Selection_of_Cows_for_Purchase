*Проект выполнен в рамках учебы в Яндекс Практикум по специальности "Специалист по Data Science расширенный"*  
*Дата выполнения март 2024 года*

# Молочное хозяйство  «Вольный луг»: отбор буренок для покупки


## 1. Введение

**Заказчик:** Молочное хозяйство «Вольный луг».  
**Дата проведения анализа:** Март-апрель 2024 года.  
**Цель, сформированная заказчиком:** Отобрать из коров, предлагаемых к покупке ассоциацией пастбищ «ЭкоФерма», только тех, которые отвечают следующим критериям:
1. Каждая из отобранных коров должна давать не менее 6000 килограммов молока в год.
2. Молоко должно соответствовать по вкусовым качества, предъявляемых молочным хозяйством «Вольный луг».


**Задачи, направленные на достижение цели:**
1. Разработать модель, прогнозирующую возможный удой каждой коровы.
2. Разработать модель, прогнозирующую вероятность получить вкусное молоко от коровы.

**План работы**
1. Загрузить и оценить данные.
2. Предварительно обработать данные: устранить дубликаты, заполнить по возможности пропуски.
3. Исследовать данные: выделить аномальные значения и принять решение о включении их в анализ. Выявить зависимости и распределения.
4. Корреляционный анализ: выявить зависимости среди данных.
5. Обучить модель линейной регрессии и проанализировать её результаты.
6. Обучить модель логистической регрессии и проанализировать её результаты.
7. Сформулировать выводы и рекомендации.

**Описание предоставленных данных**

Источники данных: 
- молочное хозяйство «Вольный луг»
- ассоциация пастбищ «ЭкоФерма».

Предоставленные датасеты:
- ferma_main.csv
- ferma_dad.csv
- cow_buy.csv

Описание датасетов

1. Файл ferma_main.csv содержит данные о стаде фермера на текущий момент. Источник данных: молочное хозяйство «Вольный луг».   
Имеющиеся данных в файле:
- id — уникальный идентификатор коровы.
- Удой, кг — масса молока, которую корова даёт в год (в килограммах).
- ЭКЕ (Энергетическая кормовая единица) — показатель питательности корма коровы.
- Сырой протеин, г — содержание сырого протеина в корме (в граммах).
- СПО (Сахаро-протеиновое соотношение) — отношение сахара к протеину в корме коровы.
- Порода — порода коровы.
- Тип пастбища — ландшафт лугов, на которых паслась корова.
- порода папы_быка — порода папы коровы.
- Жирность,% — содержание жиров в молоке (в процентах).
- Белок,% — содержание белков в молоке (в процентах).
- Вкус молока — оценка вкуса по личным критериям фермера, бинарный признак (вкусно, не вкусно).
- Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).

2. Файл ferma_dad.csv хранит имя папы каждой коровы в стаде фермера. Источник данных: молочное хозяйство «Вольный луг».  
Имеющиеся данных в файле:
- id — уникальный идентификатор коровы.
- Имя Папы — имя папы коровы.

3. Файл cow_buy.csv — это данные о коровах «ЭкоФермы», которых фермер хочет изучить перед покупкой.   
Имеющиеся данных в файле:
- Порода — порода коровы.
- Тип пастбища — ландшафт лугов, на которых паслась корова.
- порода папы_быка — порода папы коровы.
- Имя_папы — имя папы коровы.
- Текущая_жирность,% — содержание жиров в молоке (в процентах).
- Текущий_уровень_белок,% — содержание белков в молоке (в процентах).
- Возраст — возраст коровы, бинарный признак (менее_2_лет, более_2_лет).

Особенности:
- Содержание белков и жиров в молоке указано на момент продажи.
- Ассоциация «ЭкоФерма» давала коровам свой корм.
- Отсутствуют параметры корма ЭКЕ (Энергетическая кормовая единица), Сырой протеин, г и СПО (Сахаро-протеиновое соотношение). 
- Технологи заказчика пересмотрели подход к кормлению: для новых коров планируется увеличить значения каждого параметра корма на 5%.

В представленных данных отсутствуют целевые признаки: 
- Удой.
- Качество (вкус) молока.

## 8. Итоговые выводы
### 8.1 Проведенная работа
В рамках работы выполнено следующее:
1. Обработаны изначальные данные, удалены дубликаты и аномальные значения.
2. Обучены 3 модели линейной регрессии и 1 модель логистической регрессии.
3. Определены показатели точности данных моделей.  

Для улучшения качества моделей были использованы следующие методы:
- ввод дополнительный параметров (тип СПО, ЭКЕ в квадрате),
- добавлены сведения об отце коровы,
- установлен определенный порог классификации для модели логистической регрессии. 

Для оценки качества модели классификации использовалась метрика Presicion.  
4. На основании моделей спрогнозирована величина удоя и вкус молока для коров, планируемых к покупке.

### 8.2 Основные результаты
8.2.1 На основании полученных прогнозов рекомендуется к покупке только 2 коровы из представленного списка. Параметры коров следующие:

breed	pasture_type	dad_bull_breed	dad_name	fat_content	protein	age	energy_feed_unit	sugar_protein_ratio	crude_protein	type_spo	square_energy_feed_unit	predict_milk_yield	predict_taste_of_milk
0	Вис Бик Айдиал	холмистое	Айдиал	Геркулес	3.58	3.076	более_2_лет	15.276742	0.958947	2019.77191	больше или равно 0.92	233.378833	6143.847973	вкусно
10	Вис Бик Айдиал	холмистое	Айдиал	Геркулес	3.68	3.046	более_2_лет	15.276742	0.958947	2019.77191	больше или равно 0.92	233.378833	6143.847973	вкусно


8.2.2 Выявились следующие закономерности:
- Удой зависит от возраста коровы. В среднем удой больше, чем больше возраст коровы.
- Удой зависит от Энергетической кормовой единицы. Чем выше ЭКЕ, тем выше удой, но зависимость нелинейная.
- Удой зависит от Сахаро-протеинового соотношения. При соотношении выше 0,92 удой резко увеличивается.
- Среди коров с самым высоким удоем большинство коров, чей отец был породы Айдиал.
- Коровы, которые имеют наибольший удой, имеют и также вкусное молоко.

8.2.3 Рекомендации для фермера:
- Высокий удой можно достичь, если следить за питанием коров и держать ЭКЕ и СПО на высоком уровне. 
- При планировании производства необходимо учитывать, что только коровы старше 2 лет дают высокий удой. При этом не гарантируется, что после двух лет корова будет давать удой свыше 6000 кг, хотя это весьма вероятно.
- Рекомендуется обращать внимание на породу отца коровы. Вероятность высокого удоя увеличивается, если отец коровы был породы Айдиал. Среди коров, чей отец был породы Соверинг, высокий удой встречается значительно реже.
- Не принципиально, на каком пастбище пасти коров. Величина удоя от этой практически не зависит.

### 8.3 Рекомендации по улучшению прогноза
Для увеличения точности прогноза рекомендуется:
- Предоставить величины ЭКЕ и СПО для коров, планируемых к приобретению.
- Расширить классификацию по возрасту коровы: вместо старше/младше 2 лет желательно указывать конкретный возраст каждой коровы.
- Предоставить информацию о матери коровы, её породе и качестве её молока.
- Возможно на качество молока влияет наличие или отсутствие телят у каждой коровы. Рекомендуется предоставить информацию по ним.